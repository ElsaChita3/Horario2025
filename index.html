<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Horario Universitario Final</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .mod-slot {
      border: 1px solid #ccc;
      height: 50px;
      text-align: center;
      font-size: 0.7rem;
      white-space: pre-line;
      line-height: 1.2;
    }
    .selected {
      font-weight: bold;
    }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <h1 class="text-xl font-bold mb-4">üóìÔ∏è Planificador Visual por M√≥dulos</h1>
  <div class="flex gap-4">
    <div class="w-1/3 overflow-y-auto max-h-[80vh]">
      <div id="courseContainer" class="space-y-4"></div>
    </div>
    <div class="w-2/3">
      <table class="table-auto border-collapse w-full text-sm">
        <thead>
          <tr>
            <th class="w-28">M√≥dulo</th>
            <th>Lunes</th><th>Martes</th><th>Mi√©rcoles</th><th>Jueves</th><th>Viernes</th>
          </tr>
        </thead>
        <tbody>
          <tr><td class='font-bold text-center'>M√≥dulo 1 <br><span class='text-xs'>08:30-09:40</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 1'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 1'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 1'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 1'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 1'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 2 <br><span class='text-xs'>09:50-11:00</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 2'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 2'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 2'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 2'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 2'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 3 <br><span class='text-xs'>11:10-12:20</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 3'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 3'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 3'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 3'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 3'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 4 <br><span class='text-xs'>12:30-13:40</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 4'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 4'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 4'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 4'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 4'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 5 <br><span class='text-xs'>13:50-15:00</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 5'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 5'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 5'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 5'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 5'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 6 <br><span class='text-xs'>15:10-16:20</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 6'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 6'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 6'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 6'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 6'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 7 <br><span class='text-xs'>16:30-17:40</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 7'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 7'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 7'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 7'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 7'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 8 <br><span class='text-xs'>17:50-19:00</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 8'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 8'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 8'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 8'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 8'></td></tr><tr><td class='font-bold text-center'>M√≥dulo 9 <br><span class='text-xs'>19:10-20:20</span></td><td class='mod-slot' data-slot='Lunes-M√≥dulo 9'></td><td class='mod-slot' data-slot='Martes-M√≥dulo 9'></td><td class='mod-slot' data-slot='Mi√©rcoles-M√≥dulo 9'></td><td class='mod-slot' data-slot='Jueves-M√≥dulo 9'></td><td class='mod-slot' data-slot='Viernes-M√≥dulo 9'></td></tr>
        </tbody>
      </table>
    </div>
  </div>

<script>
const data = `CREATIVITY LAB,Secci√≥n 1,F. Valdivia,Jueves,M√≥dulo 1,CREATIVITY LAB (I)\nF. Valdivia,#F8BBD0\nCREATIVITY LAB,Secci√≥n 2,F. Valdivia,Jueves,M√≥dulo 3,CREATIVITY LAB (II)\nF. Valdivia,#F8BBD0\nCREATIVITY LAB,Secci√≥n 3,P. Aguirre,Lunes,Otro,CREATIVITY LAB (III)\nP. Aguirre,#F8BBD0\nCREATIVITY LAB,Secci√≥n 4,P. Aguirre,Miercoles,Otro,CREATIVITY LAB (IV)\nP. Aguirre,#F8BBD0\nDATOS PARA TOMAR DECISIONES (B-Learning),Secci√≥n 3,G. Assad,Martes,M√≥dulo 5,DATOS PARA TOMAR DECISIONES (B-Learning) (III)\nG. Assad,#DCEDC8\nDATOS PARA TOMAR DECISIONES (B-Learning),Secci√≥n 4,G. Assad,Martes,M√≥dulo 7,DATOS PARA TOMAR DECISIONES (B-Learning) (IV)\nG. Assad,#DCEDC8\nDATOS PARA TOMAR DECISIONES (online),Secci√≥n 1,JP. Salcedo,Lunes,M√≥dulo 8,DATOS PARA TOMAR DECISIONES (online) (I)\nJP. Salcedo,#FFECB3\nDATOS PARA TOMAR DECISIONES (online),Secci√≥n 2,JP. Salcedo,Jueves,M√≥dulo 8,DATOS PARA TOMAR DECISIONES (online) (II)\nJP. Salcedo,#FFECB3\nINNOVATION AND SEED CAPITAL (online),Secci√≥n 1,A. Cabezas,Viernes,M√≥dulo 1,INNOVATION AND SEED CAPITAL (online) (I)\nA. Cabezas,#FFD1DC\nINNOVATION AND SEED CAPITAL (online),Secci√≥n 2,L. Gougain,Martes,M√≥dulo 3,INNOVATION AND SEED CAPITAL (online) (II)\nL. Gougain,#FFD1DC\nINNOVATION AND SEED CAPITAL (online),Secci√≥n 3,L. Gougain,Viernes,M√≥dulo 5,INNOVATION AND SEED CAPITAL (online) (III)\nL. Gougain,#FFD1DC\nPLANIFICACI√ìN ESTRATEGICA,Secci√≥n 1,A. Sprovera,Lunes,M√≥dulo 2,PLANIFICACI√ìN ESTRATEGICA (I)\nA. Sprovera,#FFFACD\nPLANIFICACI√ìN ESTRATEGICA,Secci√≥n 2,A. Sprovera,Miercoles,M√≥dulo 1,PLANIFICACI√ìN ESTRATEGICA (II)\nA. Sprovera,#FFFACD\nPLANIFICACI√ìN ESTRATEGICA,Secci√≥n 3,Y. Gallardo,Miercoles,M√≥dulo 4,PLANIFICACI√ìN ESTRATEGICA (III)\nY. Gallardo,#FFFACD\nRAMO,Secci√≥n SECCI√ìN,PROFESOR,D√≠a,Otro,RAMO (SECCI√ìN)\nPROFESOR,#C1E1C1\nTALLER VI,Secci√≥n 1,Jaime G√≥mez,Miercoles,Otro,TALLER VI (I)\nJaime G√≥mez,#D1C4E9\nTALLER VI,Secci√≥n 1,Patricio Aguirre,Lunes,Otro,TALLER VI (I)\nPatricio Aguirre,#D1C4E9\nTALLER VI,Secci√≥n 2,Diego Perry,Viernes,M√≥dulo 1,TALLER VI (II)\nDiego Perry,#D1C4E9\nTALLER VI,Secci√≥n 2,Simon Bustamante,Martes,M√≥dulo 1,TALLER VI (II)\nSimon Bustamante,#D1C4E9\nTALLER VI,Secci√≥n 3,Juan Valdivia,Jueves,M√≥dulo 1,TALLER VI (III)\nJuan Valdivia,#D1C4E9\nTALLER VI,Secci√≥n 3,Paulina Diaz,Lunes,M√≥dulo 4,TALLER VI (III)\nPaulina Diaz,#D1C4E9`;

function toggleSection(id, bloques, li, color, label) {
  const active = li.classList.contains("bg-green-100");
  let conflict = false;

  bloques.forEach(({ dia, mod }) => {
    const cell = document.querySelector(`[data-slot="${dia}-${mod}"]`);
    if (cell && !active && cell.classList.contains("selected") && cell.dataset.section !== id) {
      conflict = true;
    }
  });

  if (conflict) {
    alert("Conflicto de horario");
    return;
  }

  bloques.forEach(({ dia, mod }) => {
    const cell = document.querySelector(`[data-slot="${dia}-${mod}"]`);
    if (!cell) return;
    if (active && cell.dataset.section === id) {
      cell.classList.remove("selected");
      cell.textContent = "";
      cell.style.backgroundColor = "";
      delete cell.dataset.section;
    } else if (!active) {
      cell.classList.add("selected");
      cell.textContent = label;
      cell.style.backgroundColor = color;
      cell.dataset.section = id;
    }
  });

  li.classList.toggle("bg-green-100");
}

function buildList() {
  const lines = data.trim().split("\n");
  const grouped = {};

  lines.forEach(line => {
    const [ramo, seccion, prof, dia, modulo, label, color] = line.split(",");
    const key = ramo + "|" + seccion + "|" + prof;
    if (!grouped[key]) grouped[key] = { bloques: [], label, color };
    grouped[key].bloques.push({ dia, mod: modulo });
  });

  const container = document.getElementById("courseContainer");

  Object.entries(grouped).forEach(([key, val]) => {
    const [ramo, seccion, prof] = key.split("|");
    const wrapper = document.createElement("div");
    const header = document.createElement("button");
    header.textContent = "üìò " + ramo;
    header.className = "w-full text-left font-bold text-blue-700 hover:underline";
    const list = document.createElement("ul");
    list.className = "ml-4 mt-2 hidden space-y-1";

    const li = document.createElement("li");
    li.textContent = `${seccion} | ${val.label.split("\\n").join(", ")}`;
    li.className = "cursor-pointer hover:bg-blue-100 border rounded p-2";
    li.onclick = () => toggleSection(key, val.bloques, li, val.color, val.label);
    list.appendChild(li);

    header.onclick = () => list.classList.toggle("hidden");
    wrapper.appendChild(header);
    wrapper.appendChild(list);
    container.appendChild(wrapper);
  });
}

buildList();
</script>
</body>
</html>
